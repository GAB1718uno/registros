"use strict";(self.webpackChunkregistrosApp=self.webpackChunkregistrosApp||[]).push([[250],{4250:(L,f,l)=>{l.r(f),l.d(f,{AuthModule:()=>J});var p=l(6895),u=l(9299),r=l(4006),v=l(5226),g=l.n(v),o=l(4650),c=l(7266);let b=(()=>{class n{constructor(e,i,t){this.fb=e,this.router=i,this._authSerice=t,this.miFormulario=this.fb.group({email:["",[r.kI.required,r.kI.email]],password:["",[r.kI.required,r.kI.minLength(8)]]})}ngOnInit(){}login(){const{email:e,password:i}=this.miFormulario.value;console.log(e,i),this._authSerice.login(e,i).subscribe(t=>{console.log(t),!0===t?this.router.navigateByUrl("/fallecidos/listado"):(g().fire("Atenci\xf3n",t,"warning"),console.log(t))})}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(r.QS),o.Y36(u.F0),o.Y36(c.e))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-login"]],decls:24,vars:2,consts:[["autocomplete","off",1,"login100-form",3,"formGroup","ngSubmit"],[1,"login100-form-title","p-b-49"],[1,"wrap-input100","m-b-23"],[1,"label-input100"],["type","email","formControlName","email","placeholder","Ingrese su email",1,"input100"],[1,"focus-input100"],[1,"wrap-input100"],["type","password","formControlName","password","placeholder","Ingrese su contrase\xf1a",1,"input100"],[1,"text-right","p-t-8","p-b-31"],[1,"container-login100-form-btn"],[1,"wrap-login100-form-btn"],[1,"login100-form-bgbtn"],["type","submit",1,"login100-form-btn",3,"disabled"],[1,"flex-col-c","p-t-60"],[1,"txt1","p-b-17"],["routerLink","/auth/registro",1,"txt2"]],template:function(e,i){1&e&&(o.TgZ(0,"form",0),o.NdJ("ngSubmit",function(){return i.login()}),o.TgZ(1,"span",1),o._uU(2," Login "),o.qZA(),o.TgZ(3,"div",2)(4,"span",3),o._uU(5,"Email"),o.qZA(),o._UZ(6,"input",4)(7,"span",5),o.qZA(),o.TgZ(8,"div",6)(9,"span",3),o._uU(10,"Password"),o.qZA(),o._UZ(11,"input",7)(12,"span",5),o.qZA(),o._UZ(13,"div",8),o.TgZ(14,"div",9)(15,"div",10),o._UZ(16,"div",11),o.TgZ(17,"button",12),o._uU(18," Login "),o.qZA()()(),o.TgZ(19,"div",13)(20,"span",14),o._uU(21," \xbfNo tienes cuenta? "),o.qZA(),o.TgZ(22,"a",15),o._uU(23," Crear una aqu\xed "),o.qZA()()()),2&e&&(o.Q6J("formGroup",i.miFormulario),o.xp6(17),o.Q6J("disabled",i.miFormulario.invalid))},dependencies:[r._Y,r.Fj,r.JJ,r.JL,u.yS,r.sg,r.u],encapsulation:2}),n})();var Z=l(2105);let A=(()=>{class n{constructor(e,i,t){this.fb=e,this._authService=i,this.router=t,this.miFormulario=this.fb.group({usuario:["",[r.kI.required]],email:["",[r.kI.required,r.kI.email]],password:["",[r.kI.required]]})}ngOnInit(){}registrar(){const{usuario:e,password:i,email:t}=this.miFormulario.value;console.log(this.miFormulario.value),this._authService.registrar(e,i,t).subscribe(a=>{console.log(a),this._authService.crearPerfilUsuario(a.nombreUsuario,a.uid).subscribe(m=>console.log(m)),!0===a.ok?this.router.navigateByUrl("/fallecidos/listado"):(console.log(a),g().fire("Atenci\xf3n",a[0].msg||a,"warning"))})}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(r.QS),o.Y36(c.e),o.Y36(u.F0))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-registro"]],decls:29,vars:2,consts:[["autocomplete","off",1,"login100-form",3,"formGroup","ngSubmit"],[1,"login100-form-title","p-b-49"],[1,"wrap-input100","m-b-23"],[1,"label-input100"],["type","usuario","formControlName","usuario","placeholder","Ingrese un nombre para el usuario",1,"input100"],[1,"focus-input100"],["type","email","formControlName","email","placeholder","Ingrese su email",1,"input100"],[1,"wrap-input100"],["type","password","formControlName","password","placeholder","Ingrese su contrase\xf1a",1,"input100"],[1,"text-right","p-t-8","p-b-31"],[1,"container-login100-form-btn"],[1,"wrap-login100-form-btn"],[1,"login100-form-bgbtn"],["type","submit",1,"login100-form-btn",3,"disabled"],[1,"flex-col-c","p-t-60"],[1,"txt1","p-b-17"],["routerLink","/auth",1,"txt2"]],template:function(e,i){1&e&&(o.TgZ(0,"form",0),o.NdJ("ngSubmit",function(){return i.registrar()}),o.TgZ(1,"span",1),o._uU(2," Nuevo Usuario "),o.qZA(),o.TgZ(3,"div",2)(4,"span",3),o._uU(5,"Nombre de Usuario"),o.qZA(),o._UZ(6,"input",4)(7,"span",5),o.qZA(),o.TgZ(8,"div",2)(9,"span",3),o._uU(10,"Email"),o.qZA(),o._UZ(11,"input",6)(12,"span",5),o.qZA(),o.TgZ(13,"div",7)(14,"span",3),o._uU(15,"Password"),o.qZA(),o._UZ(16,"input",8)(17,"span",5),o.qZA(),o._UZ(18,"div",9),o.TgZ(19,"div",10)(20,"div",11),o._UZ(21,"div",12),o.TgZ(22,"button",13),o._uU(23," Registro "),o.qZA()()(),o.TgZ(24,"div",14)(25,"span",15),o._uU(26," \xbfYa tienes una cuenta? "),o.qZA(),o.TgZ(27,"a",16),o._uU(28," Ingrese aqu\xed "),o.qZA()()()),2&e&&(o.Q6J("formGroup",i.miFormulario),o.xp6(22),o.Q6J("disabled",i.miFormulario.invalid))},dependencies:[r._Y,r.Fj,r.JJ,r.JL,u.yS,r.sg,r.u],encapsulation:2}),n})();var C=l(3900),U=l(4004),y=l(7915);let T=(()=>{class n{constructor(e,i,t,a){this.fb=e,this._activatedRoute=i,this._authService=t,this._notify=a,this.imagenMostrar="",this.usuario={},this.identidad="",this.perfiles=[],this.arrayFuturos=[],this.formPerfil=this.fb.group({usuario:["",[r.kI.required]],email:["",[r.kI.required]],nombre:["",[r.kI.required,r.kI.minLength(6)]],apellidos:["",[r.kI.required]],nacio:["",[r.kI.required]],direccion:["",[r.kI.required]],identidad:["",[r.kI.required,this.validarNif]],fotoPerfil:["",[r.kI.required]],password:["",[r.kI.required]],condiciones:[!1,[r.kI.requiredTrue]]}),this.dni_valido=!1,this.comparar=""}ngOnInit(){this._activatedRoute.params.pipe((0,C.w)(({id:e})=>this._authService.obtenerUsuario(e))).subscribe(e=>{this.usuario=e,console.log(this.usuario),this.formPerfil.patchValue(this.usuario)})}get form(){return this.formPerfil.controls}guardar(){if(this.formPerfil.valid){const e=this._authService.usuario;this._authService.obtenerPerfilUsuarioEditar().pipe((0,U.U)(i=>{console.log(i);for(let t=0;t<i.length;t++)console.log(i[t].usuarioId),console.log(e.uid),i[t].usuarioId==e.uid&&(this.arrayFuturos.push(i[t]),console.log("pas\xf3: "+[t]+"vez"),console.log(this.arrayFuturos),this.perfiles=this.arrayFuturos,console.log(this.perfiles),this._authService.actualizarPerfilUsuario(this.perfiles[0].id,this.formPerfil.value.nombre,this.formPerfil.value.apellidos,this.formPerfil.value.identidad,this.formPerfil.value.nacio,this.formPerfil.value.direccion,this.imagenSubir).subscribe(a=>a))})).subscribe(),console.log("guardado")}else this._notify.showSuccess("todos los campos deben completarse y los t\xe9rminos y condiciones aceptadas","CAMPOS INCOMPLETOS")}validarNif(e){console.log(e);const i=e.value;var t,a;return 1==/^[XYZ]?\d{5,8}[A-Z]$/.test(i)?(t=(t=(t=(t=i.substr(0,i.length-1)).replace("X",0)).replace("Y",1)).replace("Z",2),a=i.substr(i.length-1,1),"TRWAGMYFPDXBNJZSQVHLCKET".substring(t%=23,t+1)!=a.toUpperCase()?{hayError:!0}:null):{hayError:!0}}imagenSeleccionada(e){const t=e.target.files[0].name;if(e.target.files){const a=new FileReader;a.readAsDataURL(e.target.files[0]),a.onload=m=>{this.imagenMostrar=m.target.result}}this.imagenSubir=e.target.files[0],console.log(t),console.log(this.imagenSubir)}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(r.QS),o.Y36(u.gz),o.Y36(c.e),o.Y36(y.g))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-perfil"]],decls:54,vars:14,consts:[[3,"formGroup"],["fxLayout","column",1,"mb-3"],[3,"src"],[1,"mb-3"],["for","fotoPerfil",1,"form-label"],["type","file","formControlName","fotoPerfil","id","fotoPerfil",1,"form-control",3,"change"],["for","nombre",1,"form-label"],["type","text","id","nombre","name","nombre","formControlName","nombre",1,"form-control"],["id","textoAviso",1,"form-text"],["for","apellidos",1,"form-label"],["type","text","formControlName","apellidos","id","apellidos",1,"form-control"],["for","dni",1,"form-label"],["type","text","name","identidad","formControlName","identidad","id","identidad",1,"form-control"],["for","nacio",1,"form-label"],["type","date","formControlName","nacio","id","nacio",1,"form-control"],["for","direccion",1,"form-label"],["type","text","formControlName","direccion","id","direccion",1,"form-control"],[1,"mb-3","form-check"],["type","checkbox","formControlName","condiciones","id","exampleCheck1",1,"form-check-input"],["consent",""],["for","exampleCheck1",1,"form-check-label"],["type","submit",1,"btn","btn-primary","float-end",3,"click"]],template:function(e,i){1&e&&(o.TgZ(0,"form",0)(1,"div",1),o._UZ(2,"img",2),o.TgZ(3,"div")(4,"small"),o._uU(5),o.qZA()(),o.TgZ(6,"div")(7,"small"),o._uU(8),o.qZA()()(),o.TgZ(9,"div",3)(10,"label",4),o._uU(11,"Foto de Perfil"),o.qZA(),o.TgZ(12,"input",5),o.NdJ("change",function(a){return i.imagenSeleccionada(a)}),o.qZA()(),o.TgZ(13,"div",3)(14,"label",6),o._uU(15,"Nombre"),o.qZA(),o._UZ(16,"input",7),o.TgZ(17,"div",8),o._uU(18,"Solamente nombre sin apellidos."),o.qZA()(),o.TgZ(19,"div",3)(20,"label",9),o._uU(21,"Apellidos"),o.qZA(),o._UZ(22,"input",10),o.qZA(),o.TgZ(23,"div",3)(24,"label",11),o._uU(25,"Documento de Identidad"),o.qZA(),o._UZ(26,"input",12),o.qZA(),o.TgZ(27,"div",3)(28,"label",13),o._uU(29,"Fecha de Nacimiento"),o.qZA(),o._UZ(30,"input",14),o.qZA(),o.TgZ(31,"div",3)(32,"label",15),o._uU(33,"Direcci\xf3n"),o.qZA(),o._UZ(34,"input",16),o.qZA(),o.TgZ(35,"div",17),o._UZ(36,"input",18,19),o.TgZ(38,"label",20),o._uU(39,"Doy mi consentimientod"),o.qZA()(),o.TgZ(40,"div")(41,"h2"),o._uU(42),o.ALo(43,"json"),o.qZA(),o.TgZ(44,"h2"),o._uU(45),o.ALo(46,"json"),o.qZA(),o.TgZ(47,"h1"),o._uU(48),o.qZA(),o.TgZ(49,"h1"),o._uU(50),o.ALo(51,"json"),o.qZA()(),o.TgZ(52,"button",21),o.NdJ("click",function(){return i.guardar()}),o._uU(53,"Enviar datos"),o.qZA()()),2&e&&(o.Q6J("formGroup",i.formPerfil),o.xp6(2),o.s9C("src",i.imagenMostrar,o.LSH),o.xp6(3),o.hij("Usuario: ",i.usuario.usuario,""),o.xp6(3),o.hij("Email: ",i.usuario.email,""),o.xp6(34),o.hij("validar nombre: ",o.lcZ(43,8,i.form.nombre.errors),""),o.xp6(3),o.hij("validar identidad: ",o.lcZ(46,10,i.form.identidad.errors),""),o.xp6(3),o.hij("validar formulario: ",i.formPerfil.valid,""),o.xp6(2),o.hij("Dar Consentimiento: ",o.lcZ(51,12,i.form.condiciones.errors),""))},dependencies:[r._Y,r.Fj,r.Wl,r.JJ,r.JL,r.sg,r.u,p.Ts],styles:["img[_ngcontent-%COMP%]{text-align:center;vertical-align:middle;min-width:50px;max-width:100%;max-height:150px;border-radius:30px}"]}),n})();var d=l(8390),_=l(7579),q=l(8372);class w{static match(s,e,i="no coincide"){return t=>t.get(s)?.value===t.get(e)?.value?null:{[i]:!0}}}function S(n,s){1&n&&(o.TgZ(0,"div",8),o._uU(1,"La contrase\xf1a no coincide"),o.qZA())}const I=[{path:"",component:Z.C,children:[{path:"login",component:b},{path:"registro",component:A},{path:"perfil/:id",component:T,canActivate:[d.z],canLoad:[d.z]},{path:"contrasenya",component:(()=>{class n{constructor(e,i,t,a){this.fb=e,this.route=i,this._authService=t,this._usuario=a,this.usuarioActivo={},this.diferentes=!1,this.onDebounce=new o.vpe,this.debouncer=new _.x,this.formContra=this.fb.group({password1:[null,[r.kI.pattern(/^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*[!@#\$%\^&\*])(?=.{8,})/),r.kI.minLength(8)]],password2:[null,[]]},{validator:w.match("password1","password2","password-mismatch")})}ngOnInit(){this.debouncer.pipe((0,q.b)(500)).subscribe(e=>{this.onDebounce.emit(e),console.log("debouncer:",e)})}guardar(){}coincidencia(e){this.diferentes=!0;let i=e.target.value;this.debouncer.next(i),i==this.formContra.value.password1&&(this.diferentes=!1,console.log("correcto"))}volver(){this.route.navigateByUrl("/fallecidos/listado")}cambiarContrasenya(){this.usuarioActivo=this._usuario.usuario,console.log(this.usuarioActivo),this._authService.editarPassword(this.usuarioActivo.uid,this.usuarioActivo.usuario,this.usuarioActivo.email,this.formContra.value.password1).subscribe()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(r.QS),o.Y36(u.F0),o.Y36(c.e),o.Y36(c.e))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-contrasenya"]],decls:17,vars:2,consts:[[3,"formGroup"],[1,"mb-3","form-check"],["for","password",1,"form-label"],["type","password","formControlName","password1","name","password1","id","password1",1,"form-control"],["for","password1",1,"form-label"],["type","password","formControlName","password2","name","password2","id","password2",1,"form-control",3,"input"],["id","textoAviso","type","form-texto","style","color: red;",4,"ngIf"],["type","submit",1,"btn","btn-primary","float-end",3,"click"],["id","textoAviso","type","form-texto",2,"color","red"]],template:function(e,i){1&e&&(o.TgZ(0,"form",0)(1,"h3"),o._uU(2,"Cambio de Contrase\xf1a"),o.qZA(),o.TgZ(3,"div")(4,"div",1)(5,"label",2),o._uU(6,"Password Nuevo"),o.qZA(),o._UZ(7,"input",3),o.qZA(),o.TgZ(8,"div",1)(9,"label",4),o._uU(10,"Confirmar Password"),o.qZA(),o.TgZ(11,"input",5),o.NdJ("input",function(a){return i.coincidencia(a)}),o.qZA(),o.YNc(12,S,2,0,"div",6),o.qZA()(),o.TgZ(13,"button",7),o.NdJ("click",function(){return i.volver()}),o._uU(14,"Cancelar"),o.qZA(),o.TgZ(15,"button",7),o.NdJ("click",function(){return i.cambiarContrasenya()}),o._uU(16,"Cambiar Contrase\xf1a"),o.qZA()()),2&e&&(o.Q6J("formGroup",i.formContra),o.xp6(12),o.Q6J("ngIf",i.diferentes))},dependencies:[r._Y,r.Fj,r.JJ,r.JL,p.O5,r.sg,r.u],encapsulation:2}),n})(),canActivate:[d.z],canLoad:[d.z]},{path:"**",redirectTo:"login"}]}];let P=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[u.Bz.forChild(I),u.Bz]}),n})();var N=l(7372);let J=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[r.u5,p.ez,P,r.UX,N.q]}),n})()}}]);