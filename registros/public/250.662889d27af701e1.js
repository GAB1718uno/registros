"use strict";(self.webpackChunkregistrosApp=self.webpackChunkregistrosApp||[]).push([[250],{4250:(x,p,l)=>{l.r(p),l.d(p,{AuthModule:()=>J});var f=l(6895),c=l(9299),o=l(4006),b=l(5226),h=l.n(b),e=l(4650),m=l(7266);let Z=(()=>{class a{constructor(i,t,r){this.fb=i,this.router=t,this._authSerice=r,this.miFormulario=this.fb.group({email:["",[o.kI.required,o.kI.email]],password:["",[o.kI.required,o.kI.minLength(8)]]})}ngOnInit(){}login(){const{email:i,password:t}=this.miFormulario.value;console.log(i,t),this._authSerice.login(i,t).subscribe(r=>{console.log(r),!0===r?this.router.navigateByUrl("/fallecidos/listado"):(h().fire("Atenci\xf3n",r,"warning"),console.log(r))})}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(o.QS),e.Y36(c.F0),e.Y36(m.e))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-login"]],decls:24,vars:2,consts:[["autocomplete","off",1,"login100-form",3,"formGroup","ngSubmit"],[1,"login100-form-title","p-b-49"],[1,"wrap-input100","m-b-23"],[1,"label-input100"],["type","email","formControlName","email","placeholder","Ingrese su email",1,"input100"],[1,"focus-input100"],[1,"wrap-input100"],["type","password","formControlName","password","placeholder","Ingrese su contrase\xf1a",1,"input100"],[1,"text-right","p-t-8","p-b-31"],[1,"container-login100-form-btn"],[1,"wrap-login100-form-btn"],[1,"login100-form-bgbtn"],["type","submit",1,"login100-form-btn",3,"disabled"],[1,"flex-col-c","p-t-60"],[1,"txt1","p-b-17"],["routerLink","/auth/registro",1,"txt2"]],template:function(i,t){1&i&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return t.login()}),e.TgZ(1,"span",1),e._uU(2," Login "),e.qZA(),e.TgZ(3,"div",2)(4,"span",3),e._uU(5,"Email"),e.qZA(),e._UZ(6,"input",4)(7,"span",5),e.qZA(),e.TgZ(8,"div",6)(9,"span",3),e._uU(10,"Password"),e.qZA(),e._UZ(11,"input",7)(12,"span",5),e.qZA(),e._UZ(13,"div",8),e.TgZ(14,"div",9)(15,"div",10),e._UZ(16,"div",11),e.TgZ(17,"button",12),e._uU(18," Login "),e.qZA()()(),e.TgZ(19,"div",13)(20,"span",14),e._uU(21," \xbfNo tienes cuenta? "),e.qZA(),e.TgZ(22,"a",15),e._uU(23," Crear una aqu\xed "),e.qZA()()()),2&i&&(e.Q6J("formGroup",t.miFormulario),e.xp6(17),e.Q6J("disabled",t.miFormulario.invalid))},dependencies:[o._Y,o.Fj,o.JJ,o.JL,c.yS,o.sg,o.u],encapsulation:2}),a})();var A=l(2105);let C=(()=>{class a{constructor(i,t,r){this.fb=i,this._authService=t,this.router=r,this.miFormulario=this.fb.group({usuario:["",[o.kI.required]],email:["",[o.kI.required,o.kI.email]],password:["",[o.kI.required]]}),this.nombre="",this.apellidos="",this.identidad="",this.nacimiento=new Date,this.direccion="",this.avatar=""}ngOnInit(){}registrar(){const{usuario:i,password:t,email:r}=this.miFormulario.value;console.log(this.miFormulario.value),this._authService.registrar(i,t,r).subscribe(n=>{console.log(n),this._authService.crearPerfilUsuario(n.nombreUsuario,n.uid,this.nombre,this.apellidos,this.identidad,this.nacimiento,this.direccion,this.avatar).subscribe(u=>console.log(u)),!0===n.ok?this.router.navigateByUrl("/fallecidos/listado"):(console.log(n),h().fire("Atenci\xf3n",n[0].msg||n,"warning"))})}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(o.QS),e.Y36(m.e),e.Y36(c.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-registro"]],decls:29,vars:2,consts:[["autocomplete","off",1,"login100-form",3,"formGroup","ngSubmit"],[1,"login100-form-title","p-b-49"],[1,"wrap-input100","m-b-23"],[1,"label-input100"],["type","usuario","formControlName","usuario","placeholder","Ingrese un nombre para el usuario",1,"input100"],[1,"focus-input100"],["type","email","formControlName","email","placeholder","Ingrese su email",1,"input100"],[1,"wrap-input100"],["type","password","formControlName","password","placeholder","Ingrese su contrase\xf1a",1,"input100"],[1,"text-right","p-t-8","p-b-31"],[1,"container-login100-form-btn"],[1,"wrap-login100-form-btn"],[1,"login100-form-bgbtn"],["type","submit",1,"login100-form-btn",3,"disabled"],[1,"flex-col-c","p-t-60"],[1,"txt1","p-b-17"],["routerLink","/auth",1,"txt2"]],template:function(i,t){1&i&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return t.registrar()}),e.TgZ(1,"span",1),e._uU(2," Nuevo Usuario "),e.qZA(),e.TgZ(3,"div",2)(4,"span",3),e._uU(5,"Nombre de Usuario"),e.qZA(),e._UZ(6,"input",4)(7,"span",5),e.qZA(),e.TgZ(8,"div",2)(9,"span",3),e._uU(10,"Email"),e.qZA(),e._UZ(11,"input",6)(12,"span",5),e.qZA(),e.TgZ(13,"div",7)(14,"span",3),e._uU(15,"Password"),e.qZA(),e._UZ(16,"input",8)(17,"span",5),e.qZA(),e._UZ(18,"div",9),e.TgZ(19,"div",10)(20,"div",11),e._UZ(21,"div",12),e.TgZ(22,"button",13),e._uU(23," Registro "),e.qZA()()(),e.TgZ(24,"div",14)(25,"span",15),e._uU(26," \xbfYa tienes una cuenta? "),e.qZA(),e.TgZ(27,"a",16),e._uU(28," Ingrese aqu\xed "),e.qZA()()()),2&i&&(e.Q6J("formGroup",t.miFormulario),e.xp6(22),e.Q6J("disabled",t.miFormulario.invalid))},dependencies:[o._Y,o.Fj,o.JJ,o.JL,c.yS,o.sg,o.u],encapsulation:2}),a})();var U=l(3900),y=l(7915);let _=(()=>{class a{constructor(i,t,r,n,u,g){this.fb=i,this._activatedRoute=t,this._authService=r,this._usuarioActivo=n,this._notify=u,this._router=g,this.imagenMostrar="",this.usuario={},this.usuarioActivo={},this.identidad="",this.perfiles=[],this.arrayFuturos=[],this.perfilActualizado=[],this.perfilActualizado2=[],this.perfilEncontrado=[],this.formPerfil=this.fb.group({id:[""],usuario:["",[o.kI.required]],email:["",[o.kI.required]],nombre:["",[o.kI.required,o.kI.minLength(6)]],apellidos:["",[o.kI.required]],nacio:["",[o.kI.required]],direccion:["",[o.kI.required]],identidad:["",[o.kI.required,this.validarNif]],fotoPerfil:["",[o.kI.required]],password:["",[o.kI.required]],condiciones:[!1,[o.kI.requiredTrue]]}),this.dni_valido=!1,this.comparar="",this.avatarEnviar="",this.idPerfil=""}ngOnInit(){this._activatedRoute.params.pipe((0,U.w)(({id:i})=>this._authService.obtenerUsuario(i))).subscribe(i=>{this.usuario=i,console.log(this.usuario),this.formPerfil.patchValue(this.usuario)})}get form(){return this.formPerfil.controls}guardar(){if(this.formPerfil.valid){const i=this._authService.obtenerPerfilUsuarioEditar().subscribe(t=>{this.usuarioActivo=this._usuarioActivo.usuario;const r=t.filter(n=>n.usuarioId==this.usuarioActivo.uid);if(console.log(r),0==r.length){const n=this._authService.crearPerfilUsuario(this.usuarioActivo.usuario,this.usuarioActivo.uid,this.formPerfil.value.nombre,this.formPerfil.value.apellidos,this.formPerfil.value.identidad,this.formPerfil.value.nacio,this.formPerfil.value.direccion,this.imagenSubir).subscribe(u=>{console.log("Perfil Creado pues no existia"),n.unsubscribe(),this._router.navigateByUrl("/fallecidos/listado")})}else{this.idPerfil=r[0].id;const n=this._authService.actualizarPerfilUsuario(r[0].id,this.formPerfil.value.nombre,this.formPerfil.value.apellidos,this.formPerfil.value.identidad,this.formPerfil.value.nacio,this.formPerfil.value.direccion,this.imagenSubir).subscribe(u=>{console.log(u),n.unsubscribe(),this._router.navigateByUrl("/fallecidos/listado")})}i.unsubscribe()});setTimeout(()=>{this._authService.obtenerPerfilUsuarioEditar().subscribe(r=>{this.usuarioActivo=this._usuarioActivo.usuario;const n=r.filter(u=>u.usuarioId==this.usuarioActivo.uid);console.log(n),setTimeout(()=>{this._authService.editarUrlAvatarUsuario(n[0].usuarioId,n[0].avatar).subscribe(u=>console.log("Avatar actualizado en usuario"))},3e3)})},1e4)}else this._notify.showSuccess("todos los campos deben completarse y los t\xe9rminos y condiciones aceptadas","CAMPOS INCOMPLETOS")}validarNif(i){console.log(i);const t=i.value;var r,n;return 1==/^[XYZ]?\d{5,8}[A-Z]$/.test(t)?(r=(r=(r=(r=t.substr(0,t.length-1)).replace("X",0)).replace("Y",1)).replace("Z",2),n=t.substr(t.length-1,1),"TRWAGMYFPDXBNJZSQVHLCKET".substring(r%=23,r+1)!=n.toUpperCase()?{hayError:!0}:null):{hayError:!0}}imagenSeleccionada(i){const r=i.target.files[0].name;if(i.target.files){const n=new FileReader;n.readAsDataURL(i.target.files[0]),n.onload=u=>{this.imagenMostrar=u.target.result}}this.imagenSubir=i.target.files[0],console.log(r),console.log(this.imagenSubir)}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(o.QS),e.Y36(c.gz),e.Y36(m.e),e.Y36(m.e),e.Y36(y.g),e.Y36(c.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-perfil"]],decls:42,vars:4,consts:[[3,"formGroup"],["fxLayout","column",1,"mb-3"],[3,"src"],[1,"mb-3"],["for","fotoPerfil",1,"form-label"],["type","file","formControlName","fotoPerfil","id","fotoPerfil",1,"form-control",3,"change"],["for","nombre",1,"form-label"],["type","text","id","nombre","name","nombre","formControlName","nombre",1,"form-control"],["id","textoAviso",1,"form-text"],["for","apellidos",1,"form-label"],["type","text","formControlName","apellidos","id","apellidos",1,"form-control"],["for","dni",1,"form-label"],["type","text","name","identidad","formControlName","identidad","id","identidad",1,"form-control"],["for","nacio",1,"form-label"],["type","date","formControlName","nacio","id","nacio",1,"form-control"],["for","direccion",1,"form-label"],["type","text","formControlName","direccion","id","direccion",1,"form-control"],[1,"mb-3","form-check"],["type","checkbox","formControlName","condiciones","id","exampleCheck1",1,"form-check-input"],["consent",""],["for","exampleCheck1",1,"form-check-label"],["type","submit",1,"btn","btn-primary","float-end",3,"click"]],template:function(i,t){1&i&&(e.TgZ(0,"form",0)(1,"div",1),e._UZ(2,"img",2),e.TgZ(3,"div")(4,"small"),e._uU(5),e.qZA()(),e.TgZ(6,"div")(7,"small"),e._uU(8),e.qZA()()(),e.TgZ(9,"div",3)(10,"label",4),e._uU(11,"Foto de Perfil"),e.qZA(),e.TgZ(12,"input",5),e.NdJ("change",function(n){return t.imagenSeleccionada(n)}),e.qZA()(),e.TgZ(13,"div",3)(14,"label",6),e._uU(15,"Nombre"),e.qZA(),e._UZ(16,"input",7),e.TgZ(17,"div",8),e._uU(18,"Solamente nombre sin apellidos."),e.qZA()(),e.TgZ(19,"div",3)(20,"label",9),e._uU(21,"Apellidos"),e.qZA(),e._UZ(22,"input",10),e.qZA(),e.TgZ(23,"div",3)(24,"label",11),e._uU(25,"Documento de Identidad"),e.qZA(),e._UZ(26,"input",12),e.qZA(),e.TgZ(27,"div",3)(28,"label",13),e._uU(29,"Fecha de Nacimiento"),e.qZA(),e._UZ(30,"input",14),e.qZA(),e.TgZ(31,"div",3)(32,"label",15),e._uU(33,"Direcci\xf3n"),e.qZA(),e._UZ(34,"input",16),e.qZA(),e.TgZ(35,"div",17),e._UZ(36,"input",18,19),e.TgZ(38,"label",20),e._uU(39,"Doy mi consentimientod"),e.qZA()(),e.TgZ(40,"button",21),e.NdJ("click",function(){return t.guardar()}),e._uU(41,"Enviar datos"),e.qZA()()),2&i&&(e.Q6J("formGroup",t.formPerfil),e.xp6(2),e.s9C("src",t.imagenMostrar,e.LSH),e.xp6(3),e.hij("Usuario: ",t.usuario.usuario,""),e.xp6(3),e.hij("Email: ",t.usuario.email,""))},dependencies:[o._Y,o.Fj,o.Wl,o.JJ,o.JL,o.sg,o.u],styles:["img[_ngcontent-%COMP%]{text-align:center;vertical-align:middle;min-width:50px;max-width:100%;max-height:150px;border-radius:30px}"]}),a})();var d=l(8390),T=l(7579),P=l(8372);class q{static match(s,i,t="no coincide"){return r=>r.get(s)?.value===r.get(i)?.value?null:{[t]:!0}}}function w(a,s){1&a&&(e.TgZ(0,"div",8),e._uU(1,"La contrase\xf1a no coincide"),e.qZA())}const I=[{path:"",component:A.C,children:[{path:"login",component:Z},{path:"registro",component:C},{path:"perfil/:id",component:_,canActivate:[d.z],canLoad:[d.z]},{path:"contrasenya",component:(()=>{class a{constructor(i,t,r,n){this.fb=i,this.route=t,this._authService=r,this._usuario=n,this.usuarioActivo={},this.diferentes=!1,this.onDebounce=new e.vpe,this.debouncer=new T.x,this.formContra=this.fb.group({password1:[null,[o.kI.pattern(/^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*[!@#\$%\^&\*])(?=.{8,})/),o.kI.minLength(8)]],password2:[null,[]]},{validator:q.match("password1","password2","password-mismatch")})}ngOnInit(){this.debouncer.pipe((0,P.b)(500)).subscribe(i=>{this.onDebounce.emit(i),console.log("debouncer:",i)})}guardar(){}coincidencia(i){this.diferentes=!0;let t=i.target.value;this.debouncer.next(t),t==this.formContra.value.password1&&(this.diferentes=!1,console.log("correcto"))}volver(){this.route.navigateByUrl("/fallecidos/listado")}cambiarContrasenya(){this.usuarioActivo=this._usuario.usuario,console.log(this.usuarioActivo),this._authService.editarPassword(this.usuarioActivo.uid,this.usuarioActivo.usuario,this.usuarioActivo.email,this.formContra.value.password1).subscribe()}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(o.QS),e.Y36(c.F0),e.Y36(m.e),e.Y36(m.e))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-contrasenya"]],decls:17,vars:2,consts:[[3,"formGroup"],[1,"mb-3","form-check"],["for","password",1,"form-label"],["type","password","formControlName","password1","name","password1","id","password1",1,"form-control"],["for","password1",1,"form-label"],["type","password","formControlName","password2","name","password2","id","password2",1,"form-control",3,"input"],["id","textoAviso","type","form-texto","style","color: red;",4,"ngIf"],["type","submit",1,"btn","btn-primary","float-end",3,"click"],["id","textoAviso","type","form-texto",2,"color","red"]],template:function(i,t){1&i&&(e.TgZ(0,"form",0)(1,"h3"),e._uU(2,"Cambio de Contrase\xf1a"),e.qZA(),e.TgZ(3,"div")(4,"div",1)(5,"label",2),e._uU(6,"Password Nuevo"),e.qZA(),e._UZ(7,"input",3),e.qZA(),e.TgZ(8,"div",1)(9,"label",4),e._uU(10,"Confirmar Password"),e.qZA(),e.TgZ(11,"input",5),e.NdJ("input",function(n){return t.coincidencia(n)}),e.qZA(),e.YNc(12,w,2,0,"div",6),e.qZA()(),e.TgZ(13,"button",7),e.NdJ("click",function(){return t.volver()}),e._uU(14,"Cancelar"),e.qZA(),e.TgZ(15,"button",7),e.NdJ("click",function(){return t.cambiarContrasenya()}),e._uU(16,"Cambiar Contrase\xf1a"),e.qZA()()),2&i&&(e.Q6J("formGroup",t.formContra),e.xp6(12),e.Q6J("ngIf",t.diferentes))},dependencies:[o._Y,o.Fj,o.JJ,o.JL,f.O5,o.sg,o.u],encapsulation:2}),a})(),canActivate:[d.z],canLoad:[d.z]},{path:"**",redirectTo:"login"}]}];let F=(()=>{class a{}return a.\u0275fac=function(i){return new(i||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[c.Bz.forChild(I),c.Bz]}),a})();var N=l(8711);let J=(()=>{class a{}return a.\u0275fac=function(i){return new(i||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[o.u5,f.ez,F,o.UX,N.q]}),a})()}}]);